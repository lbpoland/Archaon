<html><head><title>File login_handler.c
</title></head><body bgcolor="#ffffff" TEXT="#000030" LINK="#4a529c" VLINK="#b57339">[ <a href="index.html">Package Index</a></code> | <a href="index_std.html">Mudlib Index</a></code> | <a href="index_eff.html">Effect Index</a></code> ]<br><h2>File /obj/handlers/login_handler.c</h2>
The login handler lets you have a funct called as a player logs in or out.
The funct you setup will be called when the player logs in or out.  The
object will also give you a list of all the people who are logged in. This is
a by product of its method of operation rather than anything important. 
It is quite possibly more useful to call users().
<p>
The funct which is to be called only needs to be called once as
the objects state is saved.  When a player enters, logsout or goes
net dead the funct will be called on the specified object.  The
funct will have two parameters, the first will be the player
name logging in/out and the last will be a define from /include/login.h
specifying which sort of event has occured.
<p>
A new temporary method of adding a call back to the login_handler has been
added.  This will allow you to add a call that is not saved,
so you can use an object reference instead of a file name.<p><b>See also:</b><br><a href="secure.login.c.html">/secure/login.c</a>, <a href="#efun::users">efun::users()</a> and /include/login.h
<p>Written by Furball<hr><h2>Includes</h2>
This class includes the following files <a href="include.player_handler.h.html">/include/player_handler.h</a>, <a href="include.login_handler.h.html">/include/login_handler.h</a> and <a href="include.login.h.html">/include/login.h</a><hr><h2>Class Index</h2>
<dl><dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#class_login_information"><b>login_information</b></a>
</dl><hr><h2>Method index</h2>
<dl><dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#add_dynamic_login_call"><b>add_dynamic_login_call</b></a>(string, mixed, mixed)<dd>
This method adds a funct to be called whenever a player logs
in.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#add_static_login_call"><b>add_static_login_call</b></a>(string, mixed, mixed)<dd>
This method adds a funct to be called whenever a player logs
in.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#add_to_login_queue"><b>add_to_login_queue</b></a>(object)<dd>
This method adds an object to the login queue.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#can_jump_queue"><b>can_jump_queue</b></a>(object)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#clean_lockdowns"><b>clean_lockdowns</b></a>()<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#clear_lockdowns"><b>clear_lockdowns</b></a>(string)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#clear_messages"><b>clear_messages</b></a>()<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#failed_login"><b>failed_login</b></a>(string)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#get_message"><b>get_message</b></a>(string)<dd>
This function is used to cache the login messages used by /secure/login
it costs a bit in memory but saves us having to re-read the same text
file everytime someone logs in.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#int_is_discworld_full"><b>int_is_discworld_full</b></a>(int)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#is_compressed_full"><b>is_compressed_full</b></a>(int)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#is_discworld_full"><b>is_discworld_full</b></a>(int)<dd>
Try and figure out if the mud is full or not.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#is_uncompressed_full"><b>is_uncompressed_full</b></a>(int)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#pop_from_login_queue"><b>pop_from_login_queue</b></a>()<dd>
This method returns the top element of the login queue and removes
them from it.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_best"><b>query_best</b></a>()<dd>
This returns the player name with the best alignment.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_lockdowns"><b>query_lockdowns</b></a>()<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_login_queue"><b>query_login_queue</b></a>()<dd>
This method returns the current list of people in the login
queue.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_players_on"><b>query_players_on</b></a>()<dd>
This method returns a list of the current players who are
online.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_worst"><b>query_worst</b></a>()<dd>
This returns the player name with the worst alignment.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#remove_dynamic_login_call"><b>remove_dynamic_login_call</b></a>(string, mixed, mixed)<dd>
This method removes a login call.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#remove_from_login_queue"><b>remove_from_login_queue</b></a>(object)<dd>
This method removes an object from the login queue, if they log out
or something.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#remove_static_login_call"><b>remove_static_login_call</b></a>(string, mixed, mixed)<dd>
This method removes a login call.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#site_lockeddown"><b>site_lockeddown</b></a>(string)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#tidy_players_on"><b>tidy_players_on</b></a>(string)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#update_players_on"><b>update_players_on</b></a>(string)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#write_log"><b>write_log</b></a>(string, string, int, string)<dd>
This method is used to do delayed logging to the log files.
</dl><hr><h2>Public Functions</h2>
These are functions that everyone can access.<p><dl>
.<dt><a name="add_dynamic_login_call">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>add_dynamic_login_call</b></a><pre>
int add_dynamic_login_call(string player,
mixed funct,
mixed obj)
</pre><dd>
This method adds a funct to be called whenever a player logs
in.  The funct and object are stored only for this reboot
so they may be object references or funct pointers.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - specfic player to look for "all" for everyone
<dd>func - the funct to call
<dd>obj - the object to call the funct on
<dt><b>Returns:</b>
<dd>0 on failure and 1 on success
<dt><b>See also:</b>
<dd><a href="#remove_dynamic_login_call">remove_dynamic_login_call()</a> and <a href="#add_static_login_call">add_static_login_call()
</a></dl>

<dt><a name="add_static_login_call">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>add_static_login_call</b></a><pre>
int add_static_login_call(string player,
mixed funct,
mixed obj)
</pre><dd>
This method adds a funct to be called whenever a player logs
in.  The funct and object both need to be strings so that
they are saved correctly.  This will be saved to the save file
and restored over logins.
<p>
The function will be called with two parameters, the first is the
name of the player and the second is the type of the event.  The
event types are defined in /include/login.h  The event will be one
of RECONNECT, LOGIN, LOGOUT, NETDEATH.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - specfic player to look for "all" for everyone
<dd>func - the funct to call
<dd>obj - the object to call the funct on
<dt><b>Returns:</b>
<dd>0 on failure and 1 on success
<dt><b>See also:</b>
<dd><a href="#remove_static_login_call">remove_static_login_call()</a> and <a href="#add_dynamic_login_call">add_dynamic_login_call()
</a></dl>

<dt><a name="add_to_login_queue">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>add_to_login_queue</b></a><pre>
void add_to_login_queue(object login_ob)
</pre><dd>
This method adds an object to the login queue.  This is called from
inside /secure/login.c<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>login_ob - the object to add to the queue

<dt><b>See also:</b>
<dd><a href="secure.login.c.html">/secure/login.c</a></dl>

<dt><a name="can_jump_queue">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>can_jump_queue</b></a><pre>
int can_jump_queue(object ob)
</pre>
<dt><a name="clean_lockdowns">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>clean_lockdowns</b></a><pre>
void clean_lockdowns()
</pre>
<dt><a name="clear_lockdowns">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>clear_lockdowns</b></a><pre>
void clear_lockdowns(string ip)
</pre>
<dt><a name="clear_messages">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>clear_messages</b></a><pre>
void clear_messages()
</pre>
<dt><a name="failed_login">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>failed_login</b></a><pre>
void failed_login(string ip_addr)
</pre>
<dt><a name="get_message">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>get_message</b></a><pre>
string get_message(string mess_name)
</pre><dd>
This function is used to cache the login messages used by /secure/login
it costs a bit in memory but saves us having to re-read the same text
file everytime someone logs in.
For security reasons this function will only work with files in /doc
<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>the - filename of the file to be returned
<dt><b>Returns:</b>
<dd>the text of the file.

</dl>

<dt><a name="int_is_discworld_full">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>int_is_discworld_full</b></a><pre>
int int_is_discworld_full(int logins)
</pre>
<dt><a name="is_compressed_full">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>is_compressed_full</b></a><pre>
int is_compressed_full(int logins)
</pre>
<dt><a name="is_discworld_full">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>is_discworld_full</b></a><pre>
int is_discworld_full(int logins)
</pre><dd>
Try and figure out if the mud is full or not.  Counts the number
of players and returns a true or false value.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>logins - a flag
<dt><b>Returns:</b>
<dd>1 if the mud is full, 0 if it is not

<dt><b>See also:</b>
<dd><a href="include.login.h.c.html#WITHOUT_LOGINS_NOT_IN_QUEUE">/include/login.h->WITHOUT_LOGINS_NOT_IN_QUEUE()</a>, <a href="include.login.h.c.html#WITHOUT_LOGIN_QUEUE">/include/login.h->WITHOUT_LOGIN_QUEUE()</a> and <a href="include.login.h.c.html#WITHOUT_ANY_LOGINS">/include/login.h->WITHOUT_ANY_LOGINS()</a></dl>

<dt><a name="is_uncompressed_full">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>is_uncompressed_full</b></a><pre>
int is_uncompressed_full(int logins)
</pre>
<dt><a name="pop_from_login_queue">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>pop_from_login_queue</b></a><pre>
object pop_from_login_queue()
</pre><dd>
This method returns the top element of the login queue and removes
them from it.<p>
<dd><dl>
<dt><b>Returns:</b>
<dd>the top element of the login queue, 0 if none

</dl>

<dt><a name="query_best">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_best</b></a><pre>
string query_best()
</pre><dd>
This returns the player name with the best alignment.<p>
<dd><dl>
<dt><b>Returns:</b>
<dd>player name with the best alignment

</dl>

<dt><a name="query_lockdowns">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_lockdowns</b></a><pre>
void query_lockdowns()
</pre>
<dt><a name="query_login_queue">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_login_queue</b></a><pre>
object * query_login_queue()
</pre><dd>
This method returns the current list of people in the login
queue.<p>
<dd><dl>
<dt><b>Returns:</b>
<dd>the objects in the login queue

</dl>

<dt><a name="query_players_on">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_players_on</b></a><pre>
string * query_players_on()
</pre><dd>
This method returns a list of the current players who are
online.<p>
<dd><dl>
<dt><b>Returns:</b>
<dd>the string names of the online players

</dl>

<dt><a name="query_worst">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_worst</b></a><pre>
string query_worst()
</pre><dd>
This returns the player name with the worst alignment.<p>
<dd><dl>
<dt><b>Returns:</b>
<dd>player name with the worst alignment

</dl>

<dt><a name="remove_dynamic_login_call">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>remove_dynamic_login_call</b></a><pre>
int remove_dynamic_login_call(string player,
mixed funct,
mixed obj)
</pre><dd>
This method removes a login call.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - the player specifier
<dd>funct - the funct name
<dd>obj - the object to call the funct on
<dt><b>Returns:</b>
<dd>0 on failure and 1 on success
<dt><b>See also:</b>
<dd><a href="#add_dynamic_login_call">add_dynamic_login_call()</a> and <a href="#add_static_login_call">add_static_login_call()
</a></dl>

<dt><a name="remove_from_login_queue">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>remove_from_login_queue</b></a><pre>
void remove_from_login_queue(object ob)
</pre><dd>
This method removes an object from the login queue, if they log out
or something.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>ob - the object to remove from the queue

</dl>

<dt><a name="remove_static_login_call">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>remove_static_login_call</b></a><pre>
int remove_static_login_call(string player,
mixed funct,
mixed obj)
</pre><dd>
This method removes a login call.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - the player specifier
<dd>funct - the funct name
<dd>obj - the object to call the funct on
<dt><b>Returns:</b>
<dd>0 on failure and 1 on success
<dt><b>See also:</b>
<dd><a href="#add_static_login_call">add_static_login_call()</a> and <a href="#add_dynamic_login_call">add_dynamic_login_call()
</a></dl>

<dt><a name="site_lockeddown">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>site_lockeddown</b></a><pre>
int site_lockeddown(string ip_addr)
</pre>
<dt><a name="tidy_players_on">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>tidy_players_on</b></a><pre>
int tidy_players_on(string player)
</pre>
<dt><a name="update_players_on">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>update_players_on</b></a><pre>
void update_players_on(string player)
</pre>
<dt><a name="write_log">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>write_log</b></a><pre>
void write_log(string event,
string name,
int guest,
string other)
</pre><dd>
This method is used to do delayed logging to the log files.  It will
store a bunch of entries until it is over a maximum size and then
save this to the log.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>event - the event generated
<dd>name - the name of the player the event is for
<dd>guest - if the person in question is a guest
<dd>other - other information about the event

</dl>

</dl>
<hr><h2>Classes</h2>
These are nice data types for dealing with...  Data!<p>
<dl>
<dt><a name="class_login_information">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>login_information</b></a><pre>
class login_information {
mixed ob;
string funct;
}

</pre>
</dl>
<hr>
<center><font size="-1"><a href="http://discworld.imaginary.com/login.html">Discworld MUD</a>'s distribution world wide web pages.<br>brought to you by<br><strong>Cut Me Own Throat Dibbler's <a href="http://discworld.imaginary.com/sausages.html">Sensational Sausages</a>;&nbsp;buy one while they are hot.</strong><br>File last modified: Tue, 27 Mar 2018 20:31:35 GMT<br>
<hr>Lost?  Try Discworld's <a href="http://discworld.imaginary.com/">home page</a>.</center></body></html>