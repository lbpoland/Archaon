<html><head><title>File playerinfo.c
</title></head><body bgcolor="#ffffff" TEXT="#000030" LINK="#4a529c" VLINK="#b57339">[ <a href="index.html">Package Index</a></code> | <a href="index_std.html">Mudlib Index</a></code> | <a href="index_eff.html">Effect Index</a></code> ]<br><h2>File /obj/handlers/playerinfo.c</h2>
Playerinfo database handler.

This handler collects all the fascinating information about players and
their sins. At the moment, the following events are supported:
replace (all replacements, added by Presto's wand),
gag (gagging and ungagging, added by the gagger),
suspend (player suspension, added by the "suspend" command),
meteor (meteoring a player, added by the "meteor" command),
multiplay (various events added by the multiplayer handler),
harassment (comments about cases of harassment, added via 'addevent'),
misc (misc. comments, added via 'addevent'),
cheat (currently unused)
 *
The "replace" and "multiplay" events are debounced (merged). In addition,
the "replace" events expire in 30 days.
<p>Written by Fiona
<hr><h2>Inherits</h2>
This class inherits the following classes <a href="std.object.c.html">/std/object.c</a><hr><h2>Includes</h2>
This class includes the following files <a href="include.applications.h.html">/include/applications.h</a>, <a href="include.refresh.h.html">/include/refresh.h</a>, <a href="include.player_handler.h.html">/include/player_handler.h</a>, <a href="include.playerinfo.h.html">/include/playerinfo.h</a> and <a href="include.newbiehelpers.h.html">/include/newbiehelpers.h</a><hr><h2>Class Index</h2>
<dl><dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#class_source"><b>source</b></a>
</dl><hr><h2>Method index</h2>
<dl><dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#acknowledge_alert"><b>acknowledge_alert</b></a>(object, string, string, int, string, mixed *)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#add_alt"><b>add_alt</b></a>(object, string, string)<dd>
Add an alt character name to this player's dossier.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#add_entry"><b>add_entry</b></a>(object, string, string, string, mixed *)<dd>
Add a new entry to the player's database.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#clear_alerts_for"><b>clear_alerts_for</b></a>(string)<dd>
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#decrement_alerts_for"><b>decrement_alerts_for</b></a>(string)<dd>
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#delete_alt"><b>delete_alt</b></a>(object, string, string)<dd>
Delete an alt character name from this player's dossier.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#delete_entry"><b>delete_entry</b></a>(object, string, string, int)<dd>
Delete an entry from the playerinfo database.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#increment_alerts_for"><b>increment_alerts_for</b></a>(string)<dd>
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#is_alert"><b>is_alert</b></a>(string, int)<dd>
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#load_handler_data"><b>load_handler_data</b></a>()<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#player_remove"><b>player_remove</b></a>(string)<dd>
Remove the player's data file.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_access_history"><b>query_access_history</b></a>(string)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_alerts"><b>query_alerts</b></a>()<dd>
 @return The alerts mapping.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_alerts_for"><b>query_alerts_for</b></a>(string)<dd>
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_alt_of"><b>query_alt_of</b></a>(string)<dd>
Return which player this player is an alt of (if any).
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_alts"><b>query_alts</b></a>(string)<dt><img src="images/magenta-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_deleter_ok"><b>query_deleter_ok</b></a>(string, object)<dd>
Check if the request to delete an event came from the valid source.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_dossier"><b>query_dossier</b></a>(object, string, int)<dd>
Print all entries from the given player's dossier.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_event"><b>query_event</b></a>(object, string, string)<dd>
Print all entries from the given player's dossier with the given event
type.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_events"><b>query_events</b></a>()<dd>
Answer the list of all possible events.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_interleaved"><b>query_interleaved</b></a>(object, string, string)<dd>
Print all entries for this player and all alts, in chronological order.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_name"><b>query_name</b></a>()<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_online_alerts"><b>query_online_alerts</b></a>()<dd>
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_source_ok"><b>query_source_ok</b></a>(string, string)<dd>
Check if the event has come from the valid source.
<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#query_timeouts"><b>query_timeouts</b></a>()<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#reregister_parent"><b>reregister_parent</b></a>(string)<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#save_handler_data"><b>save_handler_data</b></a>()<dt><img src="images/cyan-ball-small.gif" height=6 width=6 alt=" o ">
<a href="#stats"><b>stats</b></a>()</dl><hr><h2>Public Functions</h2>
These are functions that everyone can access.<p><dl>
.<dt><a name="acknowledge_alert">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>acknowledge_alert</b></a><pre>
int acknowledge_alert(object creator,
string player,
string event,
int idx,
string update,
mixed * extra)
</pre>
<dt><a name="add_alt">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>add_alt</b></a><pre>
string add_alt(object creator,
string player,
string alt)
</pre><dd>
Add an alt character name to this player's dossier. This function succeeds
if both characters are not "main", or only one if them is "main". Both
players will have their dossiers modified.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - the name of the player
<dd>alts - the names of the alt characters to add
<dt><b>Returns:</b>
<dd>a string describing the outcome of the function call

</dl>

<dt><a name="add_entry">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>add_entry</b></a><pre>
int add_entry(object creator,
string player,
string event,
string comment,
mixed * extra)
</pre><dd>
Add a new entry to the player's database.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>source - the creator or another object trying to add the event
<dd>player - the name of the player
<dd>event - event the name of the event to be added
<dd>comment - arbitrary comment text (more than one line is OK)
<dd>extra - arbitrary array of arbitrary objects (can be 0)
<dt><b>Returns:</b>
<dd>nonzero if the entry was successfully added to the database

</dl>

<dt><a name="clear_alerts_for">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>clear_alerts_for</b></a><pre>
void clear_alerts_for(string player)
</pre><dd><p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - The name of the player.

</dl>

<dt><a name="decrement_alerts_for">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>decrement_alerts_for</b></a><pre>
int decrement_alerts_for(string player)
</pre><dd><p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - The name of the player.
<dt><b>Returns:</b>
<dd>The updated number of alerts for that player.

</dl>

<dt><a name="delete_alt">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>delete_alt</b></a><pre>
string delete_alt(object creator,
string player,
string alt)
</pre><dd>
Delete an alt character name from this player's dossier. Note that both
players have their dossier modified.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - the name of the player
<dd>alts - the name of the alt characters to delete
<dt><b>Returns:</b>
<dd>a string describing the outcome of the function call

</dl>

<dt><a name="delete_entry">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>delete_entry</b></a><pre>
int delete_entry(object creator,
string player,
string event,
int n)
</pre><dd>
Delete an entry from the playerinfo database.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>source - the creator or another object trying to add the event
<dd>player - the name of the player
<dd>event - the name of the event of the entry being deleted
<dd>n - the index of the entry being deleted
<dt><b>Returns:</b>
<dd>nonzero if the entry was successfully deleted

</dl>

<dt><a name="increment_alerts_for">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>increment_alerts_for</b></a><pre>
int increment_alerts_for(string player)
</pre><dd><p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - The name of the player.
<dt><b>Returns:</b>
<dd>The updated number of alerts for that player.

</dl>

<dt><a name="is_alert">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>is_alert</b></a><pre>
int is_alert(string player,
int idx)
</pre><dd><p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - The name of the player
<dd>idx - The number of the event to check for alert status.
<dt><b>Returns:</b>
<dd>0 if the event is not an alert, 1 if it is.

</dl>

<dt><a name="load_handler_data">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>load_handler_data</b></a><pre>
void load_handler_data()
</pre>
<dt><a name="player_remove">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>player_remove</b></a><pre>
void player_remove(string player)
</pre><dd>
Remove the player's data file.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - the name of the player

</dl>

<dt><a name="query_access_history">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_access_history</b></a><pre>
string query_access_history(string player)
</pre>
<dt><a name="query_alerts">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_alerts</b></a><pre>
mapping query_alerts()
</pre><dd>
 @return The alerts mapping.
<p>

<dt><a name="query_alerts_for">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_alerts_for</b></a><pre>
int query_alerts_for(string player)
</pre><dd><p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>player - Name of the player to query
<dt><b>Returns:</b>
<dd>The number of alerts for that player

</dl>

<dt><a name="query_alt_of">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_alt_of</b></a><pre>
string query_alt_of(string player)
</pre><dd>
Return which player this player is an alt of (if any).
param player A players name
return the name of the players main alt.
<p>

<dt><a name="query_alts">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_alts</b></a><pre>
string * query_alts(string player)
</pre>
<dt><a name="query_dossier">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_dossier</b></a><pre>
varargs string query_dossier(object source,
string player,
int lastn)
</pre><dd>
Print all entries from the given player's dossier.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>source - the creator who requested the report
<dd>player - the name of the player

</dl>

<dt><a name="query_event">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_event</b></a><pre>
string query_event(object source,
string player,
string event)
</pre><dd>
Print all entries from the given player's dossier with the given event
type.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>source - the creator who requested the report
<dd>player - the name of the player
<dd>event - the name of the event

</dl>

<dt><a name="query_events">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_events</b></a><pre>
string * query_events()
</pre><dd>
Answer the list of all possible events.<p>
<dd><dl>
<dt><b>Returns:</b>
<dd>array of all event types recognized by the playerinfo handler

</dl>

<dt><a name="query_interleaved">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_interleaved</b></a><pre>
string query_interleaved(object source,
string player,
string event)
</pre><dd>
Print all entries for this player and all alts, in chronological order.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>source - the creator who requested the report
<dd>player - the name of the player

</dl>

<dt><a name="query_name">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_name</b></a><pre>
string query_name()
</pre>
<dt><a name="query_online_alerts">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_online_alerts</b></a><pre>
string * query_online_alerts()
</pre><dd><p>
<dd><dl>
<dt><b>Returns:</b>
<dd>A list of the currently-online players who have unacknowledged alerts

</dl>

<dt><a name="query_source_ok">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_source_ok</b></a><pre>
int query_source_ok(string event,
string source)
</pre><dd>
Check if the event has come from the valid source.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>event - the name of the event
<dd>source - the object trying to add the event
<dt><b>Returns:</b>
<dd>nonzero if the event can be added by the given source

</dl>

<dt><a name="query_timeouts">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>query_timeouts</b></a><pre>
mapping query_timeouts()
</pre>
<dt><a name="reregister_parent">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>reregister_parent</b></a><pre>
void reregister_parent(string player)
</pre>
<dt><a name="save_handler_data">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>save_handler_data</b></a><pre>
void save_handler_data()
</pre>
<dt><a name="stats">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>stats</b></a><pre>
mixed * stats()
</pre>
</dl>
<hr><h2>Protected Functions</h2>
These are functions that only objects inheriting the class can access.<p>
<dt><a name="query_deleter_ok">
<img src="images/magenta-ball.gif" width=12 height=12 alt=" * "><b>query_deleter_ok</b></a><pre>
int query_deleter_ok(string event,
object deleter)
</pre><dd>
Check if the request to delete an event came from the valid source.<p>
<dd><dl>
<dt><b>Parameters:</b>
<dd>event - the name of the event
<dd>remover - the object that tries to remove the event

</dl>


<hr><h2>Classes</h2>
These are nice data types for dealing with...  Data!<p>
<dl>
<dt><a name="class_source">
<img src="images/cyan-ball.gif" width=12 height=12 alt=" * "><b>source</b></a><pre>
class source {
string * add;
string * delete;
}

</pre>
</dl>
<hr>
<center><font size="-1"><a href="http://discworld.imaginary.com/login.html">Discworld MUD</a>'s distribution world wide web pages.<br>brought to you by<br><strong>Cut Me Own Throat Dibbler's <a href="http://discworld.imaginary.com/sausages.html">Sensational Sausages</a>;&nbsp;buy one while they are hot.</strong><br>File last modified: Tue, 27 Mar 2018 23:34:20 GMT<br>
<hr>Lost?  Try Discworld's <a href="http://discworld.imaginary.com/">home page</a>.</center></body></html>